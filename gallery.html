<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ギャラリー | konmari</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=Zen+Maru+Gothic:wght@400;500;700&family=Inter:ital,wght@0,300;0,400;0,600;0,700;1,300&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link rel="stylesheet" href="assets/css/style.css">
</head>
<body>

<div class="scroll-indicator" id="scrollBar"></div>

<!-- NAV -->
<nav id="mainNav">
  <a href="index.html" class="nav-logo">kon<span>mari</span></a>
  <ul class="nav-links">
    <li><a href="index.html">ホーム</a></li>
    <li><a href="works.html">制作実績</a></li>
    <li><a href="gallery.html" class="active">ギャラリー</a></li>
    <li><a href="index.html#speaking-wrap">登壇履歴</a></li>
    <li><a href="https://note.com/konmari" target="_blank" rel="noopener">note</a></li>
  </ul>
  <a href="https://x.com/konmari_tweet" target="_blank" rel="noopener" class="nav-cta">X でフォロー</a>
</nav>

<!-- PAGE HERO -->
<section class="page-hero">
  <div class="page-hero-blob page-hero-blob-1"></div>
  <div class="page-hero-blob page-hero-blob-2"></div>
  <span class="page-hero-eyebrow fi">
    <span class="material-icons">photo_library</span>
    Gallery
  </span>
  <h1 class="fi delay-1">生成した画像、<span class="accent">全部見せます。</span></h1>
  <p class="fi delay-2">
    Midjourney / niji・journey で制作した作品をまとめています。<br>
    実写・フォトリアルとイラスト・アニメ、2ジャンルで掲載中。
  </p>
</section>

<!-- Wave -->
<div class="wave" style="background:var(--white);">
  <svg viewBox="0 0 1440 90" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none">
    <path d="M0,45 C180,90 360,5 540,45 C720,85 900,10 1080,45 C1200,68 1360,28 1440,42 L1440,90 L0,90 Z" fill="#f9f5f0"/>
  </svg>
</div>

<!-- GALLERY -->
<div id="gallery-wrap">
  <div class="section-inner">
    <p class="section-eyebrow fi">ギャラリー</p>
    <h2 class="section-title fi delay-1">Midjourneyで<span class="accent">作ってみたもの。</span></h2>
    <p class="section-lead fi delay-2">実写・フォトリアルと、イラスト・アニメに分けて掲載しています。<br>画像は随時追加中です。</p>

    <!-- タブ -->
    <div class="gallery-tabs fi delay-2">
      <button class="tab-btn active" data-tab="photo">
        <span class="material-icons">photo_camera</span>
        実写・フォト
      </button>
      <button class="tab-btn" data-tab="illust">
        <span class="material-icons">brush</span>
        イラスト・アニメ
      </button>
    </div>

    <!-- 実写・フォトタブ -->
    <div class="gallery-panel active" id="tab-photo">
      <div class="gallery-grid" id="grid-photo"></div>
    </div>

    <!-- イラスト・アニメタブ -->
    <div class="gallery-panel" id="tab-illust">
      <div class="gallery-grid" id="grid-illust"></div>
    </div>

    <p class="gallery-add-hint fi">
      画像は随時追加しています。
      <a href="https://x.com/konmari_tweet" target="_blank" rel="noopener">X (@konmari_tweet)</a>
      で最新の生成画像を先行公開中。
    </p>
  </div>
</div>

<!-- Footer -->
<footer>
  <a href="index.html" class="footer-logo">kon<span>mari</span></a>
  <p>© 2026 konmari (@konmari_tweet). All rights reserved.</p>
  <ul class="footer-links">
    <li><a href="index.html#about-wrap">About</a></li>
    <li><a href="works.html">Works</a></li>
    <li><a href="gallery.html">Gallery</a></li>
    <li><a href="index.html#speaking-wrap">登壇</a></li>
    <li><a href="https://note.com/konmari" target="_blank" rel="noopener">note</a></li>
    <li><a href="https://x.com/konmari_tweet" target="_blank" rel="noopener">X</a></li>
  </ul>
</footer>

<script>
// スクロールプログレスバー
const scrollBar = document.getElementById('scrollBar');
window.addEventListener('scroll', () => {
  const scrolled = (window.scrollY / (document.documentElement.scrollHeight - window.innerHeight)) * 100;
  scrollBar.style.width = scrolled + '%';
}, { passive: true });

// Nav scroll
const mainNav = document.getElementById('mainNav');
window.addEventListener('scroll', () => {
  mainNav.classList.toggle('scrolled', window.scrollY > 40);
}, { passive: true });

// ギャラリー動的レンダリング
function renderGalleryItem(item) {
  const div = document.createElement('div');
  div.className = 'gallery-item';
  div.innerHTML = `
    <img src="${item.src}" alt="${item.label}"
         onerror="this.style.display='none';this.nextElementSibling.style.display='flex'">
    <div class="gallery-item-ph" style="display:none;"><span class="material-icons">image</span></div>
    <div class="gallery-item-overlay">
      <span class="gallery-item-label">${item.label}</span>
    </div>`;
  return div;
}

fetch('gallery-data.json')
  .then(r => r.json())
  .then(data => {
    const photoGrid  = document.getElementById('grid-photo');
    const illustGrid = document.getElementById('grid-illust');
    data.items.forEach(item => {
      const el = renderGalleryItem(item);
      (item.tab === 'illust' ? illustGrid : photoGrid).appendChild(el);
    });
  })
  .catch(() => {
    document.getElementById('grid-photo').innerHTML =
      '<p style="color:#aaa;padding:24px;">gallery-data.json が見つかりません。<br>node generate-gallery.js を実行してください。</p>';
  });

// Gallery tabs
document.querySelectorAll('.tab-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
    document.querySelectorAll('.gallery-panel').forEach(p => p.classList.remove('active'));
    btn.classList.add('active');
    document.getElementById('tab-' + btn.dataset.tab).classList.add('active');
  });
});

// Fade-in
document.addEventListener('DOMContentLoaded', () => {
  const items = Array.from(document.querySelectorAll('.fi'));
  const show = el => el.classList.add('visible');
  if (!('IntersectionObserver' in window)) { items.forEach(show); return; }
  const io = new IntersectionObserver((entries, observer) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) { show(entry.target); observer.unobserve(entry.target); }
    });
  }, { threshold: 0.06 });
  items.forEach(el => {
    const rect = el.getBoundingClientRect();
    if (rect.top < window.innerHeight * 0.92) show(el);
    else io.observe(el);
  });
});

// 画像ロードエラーハンドリング
document.addEventListener('DOMContentLoaded', () => {
  document.querySelectorAll('img[onerror]').forEach(img => {
    if (img.complete && img.naturalWidth === 0) img.dispatchEvent(new Event('error'));
  });
});
</script>
</body>
</html>
